function AddNewCityLocation(t,o){try{var e=0;if($(".selectedContent").each(function(){if("SelectedLocation"!==$(this).parent().attr("id")){var t=$(this).text();if(t==location)return void(e=1)}}),e||""==location||null==location)return void ShowError(pleaseTypeUniqueLocation);var n=document.getElementById("SelectedLocation"),r=n.cloneNode(!0);r.id=r.id+guid(),r.style.display="block",r.setAttribute("woeid",t),$("#SelectedLocationContainer").append(r);var a=$("#"+r.id+" > .selectedContent");a.text(o),$("#Location").val("")}catch(i){LogError(i),isWorking=!1}}function CloseSelected(t){try{var o=t.getAttribute("woeid");$.ajax({method:"get",url:location.protocol+"//"+location.host+"/"+$("#CurrentLang").val()+"/api/APIProfile/removebranchcity?woeid="+o,contentType:"application/json; charset=utf-8",headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")},success:function(){var o=document.getElementById("SelectedLocationContainer");o.removeChild(t)},fail:function(){ShowError("Error during removing element from server, please, contact our support!")}})}catch(e){LogError(e)}return window.event.stopPropagation(),!1}$(document).ready(function(){$("#Location").autocomplete({source:function(t,o){var e=t.term;e&&e.length>0&&$.getJSON(location.protocol+"//"+location.host+"/"+$("#CurrentLang").val()+"/api/APIProfile/cities?cityName="+e).done(function(t){var e=[];if(t)for(var n=0;n<t.length;n++){var r=t[n];e.push(r)}o(e)}).fail(function(){alert("Cities not found because some error happened: please, contact our support!")})},select:function(t,o){var e=o.item;return $.ajax({method:"get",url:location.protocol+"//"+location.host+"/"+$("#CurrentLang").val()+"/api/APIProfile/addbranchcity?woeid="+e.woeid,contentType:"application/json; charset=utf-8",headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")},success:function(){AddNewCityLocation(e.woeid,e.town+", "+e.country)},fail:function(){ShowError("Cannot add city, please, contact our support!")}}),!1}}).autocomplete("instance")._renderItem=function(t,o){return $("<li>").append("<a><b>"+o.country+"</b>, "+o.town+(o.admin?", "+o.admin:"")+(o.admin1?", "+o.admin1:"")+(o.admin2?", "+o.admin2:"")+"</a>").appendTo(t)},$.ajax({method:"get",url:location.protocol+"//"+location.host+"/"+$("#CurrentLang").val()+"/api/APIProfile/branchcities",contentType:"application/json; charset=utf-8",headers:{Authorization:"Bearer "+sessionStorage.getItem("accessToken")},success:function(t){if(t)for(var o=0;o<t.length;o++){var e=t[o];AddNewCityLocation(e.woeid,e.town+", "+e.country)}},fail:function(){ShowError("Error during getting the list of cities, please, contact our support!")}})});